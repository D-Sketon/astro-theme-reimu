---
import { Icon } from "astro-icon/components";

import { totalCount, totalReadingTime } from "../utils/wordCount";
import { SITE, FOOTER, BASE_URL } from "../utils/config";
import { __ } from "../utils/i18n";

const totalcount = await totalCount();
const totalmin2read = await totalReadingTime();
---

<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div class="outer">
    <div id="footer-info" class="inner">
      <div>
        <Icon name="fa6-regular:copyright" />
        {FOOTER.since}-{new Date().getFullYear()}
        <span class="footer-info-sep"></span>
        {SITE.author || SITE.title}
      </div>
      {
        FOOTER.powered && (
          <div>
            {__("powered_by")}&nbsp;
            <a
              href="https://astro.build/"
              rel="noopener external nofollow noreferrer"
              target="_blank"
            >
              Astro
            </a>
            &nbsp; Theme.
            <a
              href="https://github.com/D-Sketon/astro-theme-reimu"
              rel="noopener external nofollow noreferrer"
              target="_blank"
            >
              Reimu
            </a>
          </div>
        )
      }
      {
        FOOTER.count && (
          <div>
            <Icon name="fa6-solid:paintbrush" />
            &nbsp;
            {totalcount}
            &nbsp;|&nbsp;
            <Icon name="fa6-solid:mug-saucer" />
            &nbsp;
            {totalmin2read}
          </div>
        )
      }
      {
        FOOTER.busuanzi && (
          <div>
            <Icon name="fa6-solid:eye" />
            &nbsp;
            <span id="busuanzi_container_site_pv">
              {__("busuanzi.pv")}&nbsp;
              <span id="busuanzi_value_site_pv" />
            </span>
            &nbsp;|&nbsp;
            <Icon name="fa6-solid:user" />
            &nbsp;
            <span id="busuanzi_container_site_uv">
              {__("busuanzi.uv")}&nbsp;
              <span id="busuanzi_value_site_uv" />
            </span>
          </div>
        )
      }
      {
        FOOTER.icp?.icpnumber && (
          <div class="footer-beian">
            <a
              target="_blank"
              rel="noopener external nofollow noreferrer"
              href="https://beian.miit.gov.cn"
            >
              {FOOTER.icp.icpnumber}
            </a>
          </div>
        )
      }
      {
        FOOTER.icp?.beian && FOOTER.icp?.recordcode && (
          <div class="footer-beian">
            <img
              style="object-fit: contain;margin-right: 2px;"
              src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAMAAAD3n0w0AAAC4lBMVEUAAAD+/ODz6Kr//+PYrn3x167oxnyaaVzhs2ifaFXbrGLkvFnpyF7v2X/kwm3cp1nhsGfqw3rZqG3ntVzjrFPt3oDjvGnfr2fbnFGti3q0lH7ktoLep1zdqVPryXn9v1T4znr/74bnvGz034v+2I/ktoDz6ZLkwY/Dfz7buoftzYbq2IPr0pjs3bLv6KPRrnbKhFv79ND488n/+dDZr4Lx38f/+cH/95f42oL7/97s2Y3++uzw1rvTk3ABAW0AAHnqxl7ktV3/0ljksE7XPiDWHRfOAAJrdodyeIKUj4EAAIAABHfyy24GA2ftzWYAAGPpwWD/217syVuTeFrqvVnmuVnrwFfislP+xVLnwFHpuFDVkEbdmkXysETeoETpgj7ThT3XdTg5FDjdhTXWZTDaTCm7TCbSOSDUIRnJJxPQFg2Ej5kcPpdyhZSptJEACJFpfo4AG44XMInFvYfTvIejmYS9un7FrnwAEHp8enny2HjWwHjKtnhcX3jYzHeNhnfu2HWUjHX34nSsonPz5HLNwnHu1HD70m9WTm//723pym3x02ndtmn/0mbnxGa0o2ZeWWbwzWT8zGT/4mPqymLtwmJuYmLvymH/vmB5ZGC9kF4MAF3ru1zmu1zou1mnjVn4xFjYnli0mVi5i1jiqVfyyVbmtlbXkVNUOFPlvFLNrFKjfVLjwFHuvlBgHlDsuU9ONU9ODk7/2E02Gk3gpEzcpEzpsUvjqkralkqEaUr/tUnorkngjkf7n0bXikb6xERCJETemEPckUG1gD/ooD3Ulj3jkz3TZT3WjjzOeDqBWDr3pDnglTlMADnbbTf2gjbkbzaTYDZpAjbplzTtcTTEazPXXzOeXzDscS3MPi38jizJWSrVSCrrXynzfCjVdCjZRyjTQCbFUiTlYCPLPSHVNCHwXh7iRh7GPh3PLBr9LRTRDBG/ABG2ABCxDg7BDAvUAwv9KwrEGArTBAjZAAbJAAJ7jjdaAAAAPnRSTlMACEIarGn7+/n39fTw7Ozr5+bl5OTh4NvS0cvHxsbEw8G+vLqysaufnJiVk4yDfG9dXFpMSEFBNTApJyEcFLSeMvYAAAFySURBVBjTYsAHmFmlJFmZUYTMWDivn9q5mp3FGCHGOCvp4tXHN3qakxYzwrUqbAi+9zk91W1v3goVqKglx+YJtzIyXj7Iej/D/YCgFVjQvNFr/rMPT11fp3+9W2ZXbwESs5H39D78/Iuri4urm0udXaWiNVBQ/3Sp16LzbrePrtmTdaXVztNJFyioebk8f9r+tBcpief2TZ5pXxyrDhQUSvbJsUuLv/Pk2sMLx32Lqs6IAwUB4zq5K9f+7ceUR4nxr97YFUQkiAEFVeMmlRSeffcpMzP15qWKmvZwLaCg9KElvdne/v4b1832tfcIdNwuBxRkW7j8mE91sHv/qtoOj6lHYpx5gYJGK7dG318QuCki1qnTKTk6PIgJ5HpDnsiEE35znOdN7I7Z0cUHFmMwFXBwWBbmEDA9JC60rY8fIqjc1ODoGOIcEHVwS+hcvxY1SGhqc0ctXbtt/e6woMgponqwALU10JCVEBGWUdIxwR1hAKaOh2BwM3MwAAAAAElFTkSuQmCC"
              alt=""
            />
            <a
              target="_blank"
              rel="noopener external nofollow noreferrer"
              href={`https://beian.mps.gov.cn/#/query/webSearch?code=${FOOTER.icp.recordcode}`}
            >
              {FOOTER.icp.beian}
            </a>
          </div>
        )
      }
      {
        FOOTER.moe_icp?.icpnumber && (
          <div class="footer-beian">
            <img
              style="object-fit: contain;margin-right: 2px;"
              src="https://icp.gov.moe/images/ico64.png"
              alt=""
              width="24"
              height="24"
            />
            <a
              target="_blank"
              rel="noopener external nofollow noreferrer"
              href={`https://icp.gov.moe/?keyword=${FOOTER.moe_icp.icpnumber}`}
            >
              萌ICP备{FOOTER.moe_icp.icpnumber}号
            </a>
          </div>
        )
      }
    </div>
  </div>
</footer>

<style lang="stylus" define:vars={{ imageUrl: 'url('+`${BASE_URL}/images/taichi.png`+')' }}>
  #footer {
    background: linear-gradient(
      to top,
      var(--color-footer-background) 50%,
      transparent
    );
    padding: 40px 0 20px;
    color: var(--grey-9);
    transition: 1s;

    &:hover {
      .footer-line {
        transition: opacity 0.3s;
        opacity: 0.5;
      }
    }

    a {
      color: var(--color-link);
      text-decoration: none;

      &:hover {
        text-decoration: underline;
      }
    }
  }

  .footer-beian {
    a {
      color: var(--grey-9) !important;
    }
  }

  .footer-line {
    margin: 20px 0 40px;
    opacity: 0.3;
    width: 200%;
    height: 10px;
    background: linear-gradient(to left, var(--red-1) 50%, transparent 0%) repeat-x 0 0 / 100px 10px;
    transition: opacity 0.3s;
    animation: transform-all 3s linear infinite;
    filter: drop-shadow(0px 0px 2px var(--red-1));
  }

  #footer-info {
    line-height: 1.67;
    font-size: 0.85em;

    div {
      margin: 8px 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }

  .footer-info-sep {
    width: 24px;
    height: 24px;
    opacity: 0.8;
    background: var(--imageUrl) no-repeat center / 80%;
    animation: rotate-all 3s infinite;
    animation-timing-function: linear;
  }

  @keyframes rotate-all {
    100% {
      transform: rotate(360deg);
    }
  }

  @keyframes transform-all {
    100% {
      transform: translateX(-100px);
    }
  }
</style>
