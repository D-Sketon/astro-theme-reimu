const f=c=>document.querySelector(c),i=c=>document.querySelectorAll(c),y=c=>new Promise(r=>{"onscrollend"in window?(document.addEventListener("scrollend",r,{once:!0}),c.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})):(c.scrollIntoView({block:"center",inline:"center"}),r(null))});let a=[];function w(){const c=function(){this.classList.contains("current")||(i(".sidebar-toc-btn").forEach(e=>e.classList.add("current")),i(".sidebar-common-btn").forEach(e=>e.classList.remove("current")),i(".sidebar-toc-sidebar").forEach(e=>e.classList.remove("hidden")),i(".sidebar-common-sidebar").forEach(e=>e.classList.add("hidden")))},r=function(){this.classList.contains("current")||(i(".sidebar-common-btn").forEach(e=>e.classList.add("current")),i(".sidebar-toc-btn").forEach(e=>e.classList.remove("current")),i(".sidebar-common-sidebar").forEach(e=>e.classList.remove("hidden")),i(".sidebar-toc-sidebar").forEach(e=>e.classList.add("hidden")))};i(".sidebar-toc-btn").forEach(e=>{e.addEventListener("click",c),a.push(()=>e.removeEventListener("click",c))}),i(".sidebar-common-btn").forEach(e=>{e.addEventListener("click",r),a.push(()=>e.removeEventListener("click",r))})}let m=!1;function I(){const c=f("#main-nav-toggle"),r=f("#mask"),e=()=>{m||(m=!0,document.body.classList.toggle("mobile-nav-on"),r?.classList.remove("hide"),setTimeout(()=>{m=!1},300))},b=()=>{m||!document.body.classList.contains("mobile-nav-on")||(document.body.classList.remove("mobile-nav-on"),r?.classList.add("hide"))};c&&(c.addEventListener("click",e),a.push(()=>c.removeEventListener("click",e))),r&&(r.addEventListener("click",b),a.push(()=>r.removeEventListener("click",b)));const u=()=>{m||!document.body.classList.contains("mobile-nav-on")||(document.body.classList.remove("mobile-nav-on"),r?.classList.add("hide"))};i("#mobile-nav .toc-link").forEach(l=>{l.addEventListener("click",u),a.push(()=>l.removeEventListener("click",u))});const d=()=>{m||!document.body.classList.contains("mobile-nav-on")||setTimeout(()=>{document.body.classList.remove("mobile-nav-on"),r?.classList.add("hide")},200)};i("#mobile-nav .sidebar-menu-link-dummy").forEach(l=>{l.addEventListener("click",d),a.push(()=>l.removeEventListener("click",d))})}function S(){const c=f("#sidebar");if(!c)return;const r=getComputedStyle(c).display==="block"?Array.from(i("#sidebar .sidebar-toc-wrapper li")):Array.from(i("#mobile-nav .sidebar-toc-wrapper li"));if(!r.length)return;let e=null;const b=(o,t)=>{o.preventDefault();const n=document.getElementById(decodeURI(o.currentTarget.getAttribute("href")).slice(1));n&&(e=t,y(n).then(()=>{l(t),e=null}))},u=new Map,d=[...r].map((o,t)=>{const n=o.querySelector("a.toc-link"),h=v=>b(v,t);n&&(n.addEventListener("click",h),u.set(n,h));const s=document.getElementById(decodeURI(n?.getAttribute("href")||"").slice(1));if(!s)return null;const L=s.querySelector("a");if(L){const v=g=>b(g,t);L.addEventListener("click",v),u.set(L,v)}return s}).filter(Boolean),l=o=>{const t=r[o];if(!t||t.classList.contains("current"))return;i(".sidebar-toc-wrapper .active, .sidebar-toc-wrapper .current").forEach(s=>{s.classList.remove("active","current")}),d.forEach(s=>{s.classList.remove("active")}),t.classList.add("active","current"),d[o]?.classList.add("active");let n=t.parentNode;for(;n&&!n.matches(".sidebar-toc-sidebar");){if(n.matches("li")){n.classList.add("active");const s=document.getElementById(decodeURI(n.querySelector("a.toc-link").getAttribute("href").slice(1)));s&&s.classList.add("active")}n=n.parentNode}if(f(".sidebar-toc-sidebar:not(.hidden)")){const s=f(".sidebar-toc-wrapper");if(!s)return;s.scrollTo({top:s.scrollTop+t.offsetTop-t.offsetHeight/2,behavior:"smooth"})}},k=o=>{let t=0,n=o[t];if(n.boundingClientRect.top>0)return d.indexOf(n.target);for(;t<o.length&&o[t].boundingClientRect.top<=0;t++)n=o[t];return d.indexOf(n.target)},p=new IntersectionObserver(o=>{const t=k(o)+(window.diffY>0?1:0);e===null&&l(t)},{rootMargin:"0px 0px -100% 0px",threshold:0});d.forEach(o=>{o&&p.observe(o)}),a.push(()=>{p.disconnect(),u.forEach((o,t)=>{t.removeEventListener("click",o)})})}function T(){a.forEach(c=>c()),a=[]}function E(){w(),I(),S()}E();document.addEventListener("astro:page-load",E);document.addEventListener("astro:before-swap",T);
